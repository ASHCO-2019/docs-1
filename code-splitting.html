<!DOCTYPE html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=description content=""><meta name=author content=""><link rel=stylesheet href=css/doc.css><title>code splitting</title><body><script src=js/doc.js charset=utf-8 async></script><div class=container><div class=row><div class=col-md-3><div class=logo><ul class=cube-inner><li class=front></li><li class=back></li><li class=right></li><li class=left></li><li class=top></li><li class=bottom></li></ul><ul class=cube><li class=front></li><li class=back></li><li class=right></li><li class=left></li><li class=top></li><li class=bottom></li><li class=floor></li></ul></div><div class=name>webpack</div><div class=tagline>MODULE BUNDLER</div><div class=sidebar><p><a href=.>Home</a></p><ul><li>Getting Started<ul><li><a href=motivation.html>Motivation</a></li><li><a href=what-is-webpack.html>What is webpack?</a></li><li><a href=installation.html>Installation</a> (WIP)</li><li><a href=usage.html>Usage</a> (WIP)</li><li>Require Modules (WIP)</li><li>Vendor Modules (WIP)</li><li><a href=using-loaders.html>Using Loaders</a></li><li>Dev Tools (WIP)</li></ul></li><li>Step-by-step tutorials<ul><li><a href="http://webpack.github.io/docs/tutorials/getting-started/">Getting started</a></li></ul></li><li>Guides<ul><li><a href=commonjs.html>CommonJs</a></li><li><a href=amd.html>AMD</a></li><li><a href=usage-with-grunt.html>Usage with Grunt</a></li><li><a href=usage-with-gulp.html>Usage with gulp</a></li><li><a href=webpack-for-browserify-users.html>webpack for browserify users</a></li><li><a href=code-splitting.html>Code Splitting</a></li><li><a href=optimization.html>Optimization</a></li><li><a href=long-time-caching.html>Long-time Caching</a></li><li>How to write a loader (WIP)</li><li>How to write a plugin (WIP)</li><li><a href=shimming-modules.html>Shimming modules</a></li><li><a href=testing.html>Testing</a></li><li><a href=comparison.html>Comparison</a></li></ul></li><li>Lists<ul><li><a href=list-of-loaders.html>List of loaders</a></li><li><a href=list-of-plugins.html>List of plugins</a></li></ul></li><li>API<ul><li><a href=configuration.html>Configuration</a></li><li><a href=cli.html>CLI</a></li><li><a href=node.js-api.html>Node.js API</a></li><li><a href=api-in-modules.html>API in modules</a></li><li><a href=loaders.html>Loaders</a></li><li><a href=plugins.html>Plugins</a></li><li><a href=context.html>Context</a></li><li><a href=resolving.html>Resolving</a></li><li><a href=hot-module-replacement.html>Hot Module Replacement</a></li><li>Dev Tools<ul><li><a href=webpack-dev-server.html>webpack-dev-server</a></li><li><a href=webpack-dev-middleware.html>webpack-dev-middleware</a></li></ul></li></ul></li><li>Development<ul><li><a href=changelog.html>Changelog</a></li><li><a href=roadmap.html>Roadmap</a></li><li><a href=ideas.html>Ideas</a></li><li>Contributing (WIP)</li></ul></li></ul></div></div><div class=col-md-9><div class=pull-right><a href=https://github.com/webpack/docs/wiki/code-splitting/_edit id=wikieditlink>Edit</a></div><div class=row><div class=col-md-12><div class=page-header><h1 id=wikititle>code splitting</h1></div></div></div><div class=row><div id=wiki class=col-md-12><div class=contents><ul><li><a href=#defining-a-split-point>Defining a split point</a><ul><li><a href=#require-ensure-commonjs><code>require.ensure</code> (CommonJs)</a></li><li><a href=#require-amd><code>require</code> (AMD)</a></li></ul></li><li><a href=#chunk-content>Chunk content</a></li><li><a href=#chunk-optimization>Chunk optimization</a></li><li><a href=#chunk-loading>Chunk loading</a></li><li><a href=#chunk-types>Chunk types</a><ul><li><a href=#entry-chunk>Entry chunk</a></li><li><a href=#normal-chunk>Normal chunk</a></li><li><a href=#initial-chunk-non-entry>Initial chunk (non-entry)</a></li></ul></li><li><a href=#multiple-entry-chunks>Multiple entry chunks</a><ul><li><a href=#running-multiple-entry-points>Running multiple entry points</a></li></ul></li><li><a href=#commons-chunk>Commons chunk</a></li><li><a href=#optimization>Optimization</a></li><li><a href=#named-chunks>Named chunks</a></li><li><a href=#require-include><code>require.include</code></a></li><li><a href=#examples>Examples</a></li></ul></div><p>For big web apps it’s not efficient to put all code into a single file. Especially if some blocks of code are only required under some circumstances. webpack has a feature to split you codebase into so called chunks which are loaded on demand. This feature is also called “code splitting”. Names for similar features in other bundlers: layers, rollups, fragments.</p><p>It’s any opt-in feature. You can define split point in your code base. webpack cares for the dependencies, output files and runtime stuff.</p><h2 id=defining-a-split-point><a class=anchor href=#defining-a-split-point>&rarr;</a>Defining a split point</h2><p>AMD and CommonJs specify different methods to load code on demand. Both are supported and act as split points:</p><h3 id=require-ensure-commonjs><a class=anchor href=#require-ensure-commonjs>&rarr;</a><code>require.ensure</code> (CommonJs)</h3><pre><code>require.ensure(dependencies, callback)</code></pre><p>The <code>require.ensure</code> method ensures that every dependency in <code>dependencies</code> can be synchronously required when calling the <code>callback</code>. <code>callback</code> is called with the <code>require</code> function as parameter.</p><p>Example:</p><pre><code>require.ensure([<span class=string>"module-a"</span>, <span class=string>"module-b"</span>], <span class=function><span class=keyword>function</span><span class=params>(require)</span> {</span>
    <span class=keyword>var</span> a = require(<span class=string>"module-a"</span>);
    <span class=comment>// ...</span>
});</code></pre><p>Note: <code>require.ensure</code> only loads the modules, it doesn’t evaluate them.</p><h3 id=require-amd><a class=anchor href=#require-amd>&rarr;</a><code>require</code> (AMD)</h3><p>The AMD spec defines a asynchronous <code>require</code> method with this definition:</p><pre><code>require(dependencies, callback)</code></pre><p>When called all <code>dependencies</code> are loaded and the <code>callback</code> is called with the exports of the loaded <code>dependencies</code>.</p><p>Example:</p><pre><code>require([<span class=string>"module-a"</span>, <span class=string>"module-b"</span>], <span class=function><span class=keyword>function</span><span class=params>(a, b)</span> {</span>
    <span class=comment>// ...</span>
});</code></pre><p>Note: AMD <code>require</code> loads and evaluate the modules. In webpack modules are evaluated left to right.</p><p>Note: It’s allowed to omit the callback.</p><h2 id=chunk-content><a class=anchor href=#chunk-content>&rarr;</a>Chunk content</h2><p>All dependencies at a split point go into a new chunk. Dependencies are also recursivly added.</p><p>If you pass a function expression (or bound function expression) as callback to the split point, webpack automatically puts all dependencies required in this function expression into the chunk too.</p><h2 id=chunk-optimization><a class=anchor href=#chunk-optimization>&rarr;</a>Chunk optimization</h2><p>If two chunks contain the same modules, they are merged into one. This can cause chunks to have multiple parents.</p><p>If a module is available in all parents of a chunk, it’s removed from that chunk.</p><p>If a chunk contains all modules of another chunk, this is stored. It fulfill multiple chunks.</p><h2 id=chunk-loading><a class=anchor href=#chunk-loading>&rarr;</a>Chunk loading</h2><p>Depending on the configuration option <code>target</code> a runtime logic for chunk loading is added to the bundle. I. e. for the <code>web</code> target chunks are loaded via jsonp. A chunk is only loaded once and parallel requests are merged into one. The runtime checks for loaded chunks whether they fulfill multiple chunks.</p><h2 id=chunk-types><a class=anchor href=#chunk-types>&rarr;</a>Chunk types</h2><h3 id=entry-chunk><a class=anchor href=#entry-chunk>&rarr;</a>Entry chunk</h3><p>A entry chunks contains the runtime plus a bunch of modules. If the chunk contains the module <code><span class=number>0</span></code> the runtime executes it. If not, it waits for chunks that contains the module <code><span class=number>0</span></code> and executes it (every time when there is a chunk with a module <code><span class=number>0</span></code>).</p><h3 id=normal-chunk><a class=anchor href=#normal-chunk>&rarr;</a>Normal chunk</h3><p>A normal chunk contains no runtime. It only contains a bunch of modules. The structure depends on the chunk loading algorithm. I. e. for jsonp the modules are wrapped in a jsonp callback function. The chunk also contains a list of chunk id that it fulfills.</p><h3 id=initial-chunk-non-entry><a class=anchor href=#initial-chunk-non-entry>&rarr;</a>Initial chunk (non-entry)</h3><p>A initial chunk is a normal chunk. The only difference is that optimization threads it as more important because it counts toward the initial loading time (like entry chunks). That chunk type can occur in combination with the <code>CommonsChunkPlugin</code>.</p><h2 id=multiple-entry-chunks><a class=anchor href=#multiple-entry-chunks>&rarr;</a>Multiple entry chunks</h2><p>It’s possible to <a href=configuration.html>configure</a> multiple entry points that will result in multiple entry chunks. The entry chunk contains the runtime and there must only be one runtime on a page (there are exceptions).</p><h3 id=running-multiple-entry-points><a class=anchor href=#running-multiple-entry-points>&rarr;</a>Running multiple entry points</h3><p>With the <code>CommonsChunkPlugin</code> the runtime is moved to the commons chunk. The entry points are now in initial chunks. While only one entry chunk can be loaded, multiple initial chunks can be loaded. This exposes the possibility to run multiple entry points in a single page.</p><p>Example:</p><pre><code>{
    entry: { a: <span class=string>"./a"</span>, b: <span class=string>"./b"</span> },
    output: { filename: <span class=string>"[name].js"</span> },
    plugins: [ <span class=keyword>new</span> webpack.CommonsChunkPlugin(<span class=string>"init.js"</span>) ]
}</code></pre><pre><code><span class=tag>&lt;<span class=title>script</span> <span class=attribute>src</span>=<span class=value>"init.js"</span>&gt;</span><span class=javascript></span><span class=tag>&lt;/<span class=title>script</span>&gt;</span>
<span class=tag>&lt;<span class=title>script</span> <span class=attribute>src</span>=<span class=value>"a.js"</span>&gt;</span><span class=javascript></span><span class=tag>&lt;/<span class=title>script</span>&gt;</span>
<span class=tag>&lt;<span class=title>script</span> <span class=attribute>src</span>=<span class=value>"b.js"</span>&gt;</span><span class=javascript></span><span class=tag>&lt;/<span class=title>script</span>&gt;</span></code></pre><h2 id=commons-chunk><a class=anchor href=#commons-chunk>&rarr;</a>Commons chunk</h2><p>The <code>CommonsChunkPlugin</code> can move modules that occur in multiple entry chunks to a new entry chunk (the commons chunk). The runtime is moved to the commons chunk too. This means the old entry chunks are initial chunks now. See all options in the <a href=list-of-plugins.html>list of plugins</a>.</p><h2 id=optimization><a class=anchor href=#optimization>&rarr;</a>Optimization</h2><p>There are optimizing plugins that can merge chunks depending on specific criteria. See <a href=list-of-plugins.html>list of plugins</a>.</p><ul><li><code>LimitChunkCountPlugin</code></li><li><code>MinChunkSizePlugin</code></li></ul><h2 id=named-chunks><a class=anchor href=#named-chunks>&rarr;</a>Named chunks</h2><p>The <code>require.ensure</code> function accepts an additional 3rd parameter. This must be a string. If two split point pass the same string they use the same chunk.</p><h2 id=require-include><a class=anchor href=#require-include>&rarr;</a><code>require.include</code></h2><pre><code>require.include(request)</code></pre><p><code>require.include</code> is a webpack specific function that adds a module to the current chunk, but doesn’t evaluate it (The statement is removed from the bundle).</p><p>Example:</p><pre><code>require.ensure([<span class=string>"./file"</span>], <span class=function><span class=keyword>function</span><span class=params>(require)</span> {</span>
  require(<span class=string>"./file2"</span>);
});

<span class=comment>// is equals to</span>

require.ensure([], <span class=function><span class=keyword>function</span><span class=params>(require)</span> {</span>
  require.include(<span class=string>"./file"</span>);
  require(<span class=string>"./file2"</span>);
});</code></pre><p><code>require.include</code> can be useful if a module is in multiple child chunks. A <code>require.include</code> in the parent would include the module and the instances of the modules in the chunk chunks would disappear.</p><h2 id=examples><a class=anchor href=#examples>&rarr;</a>Examples</h2><ul><li><a href=https://github.com/webpack/webpack/tree/master/examples/code-splitting>Simple</a></li><li><a href=https://github.com/webpack/webpack/tree/master/examples/code-splitting-bundle-loader>with bundle-loader</a></li><li><a href=https://github.com/webpack/webpack/tree/master/examples/code-splitted-require.context>with context</a></li><li><a href=https://github.com/webpack/webpack/tree/master/examples/code-splitted-require.context-amd>with amd and context</a></li><li><a href=https://github.com/webpack/webpack/tree/master/examples/code-splitted-dedupe>with deduplication</a></li><li><a href=https://github.com/webpack/webpack/tree/master/examples/named-chunks>named-chunks</a></li><li><a href=https://github.com/webpack/webpack/tree/master/examples/multiple-entry-points>multiple entry chunks</a></li><li><a href=https://github.com/webpack/webpack/tree/master/examples/multiple-commons-chunks>multiple commons chunks</a></li></ul><p>For a running demo see the <a href="http://webpack.github.io/example-app/">example-app</a>. Check Network in DevTools.</p></div></div></div></div></div><a href=https://github.com/webpack/webpack><img style="position: absolute; top: 0; left: 0; border: 0" src=https://s3.amazonaws.com/github/ribbons/forkme_left_orange_ff7600.png alt="Fork me on GitHub"></a>